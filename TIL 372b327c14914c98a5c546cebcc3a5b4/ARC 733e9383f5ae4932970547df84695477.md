# ARC

Swift는 앱의 메모리 사용을 관리하고 추적하기 위해서 Automatic Reference Counting (ARC)을 사용합니다.

대부분의 경우에는 ARC에 의해서 자동으로 메모리 관리가 되고 있으므로 따로 신경을 쓰지 않아도 됩니다.

ARC는 생성된 클래스 인스턴스가 더이상 필요하지 않게되면 자동적으로 메모리에서 해제합니다.

다만 ARC가 정상적으로 작동하기 위해서 개발자가 추가적으로 ARC에게 정보를 제공해야 하는 경우도 있습니다.

Reference counting은 클래스 인스턴스에만 적용됩니다.

구조체와 열거형은 참조 타입이 아닌 값 타입으로 참조로 저장 또는 전달되지 않습니다.

## How ARC Works

새로운 클래스 인스턴스가 생성될 때 ARC는 인스턴스 정보가 저장되는 메모리를 할당합니다.

이 메모리에는 인스턴스의 타입에 대한 정보와 해당 인스턴스와 관련된 저장 프로퍼티 값이 저장됩니다.

생성된 인스턴스가 더이상 필요하지 않게되었을 때 ARC는 메모리를 해제합니다.

ARC가 인스턴스를 메모리에서 해제한 이후에는,

인스턴스 프로퍼티에 접근하거나 인스턴스 메서드를 실행할 수 없습니다.

만약 해당 인스턴스로 접근을 시도한다면 앱은 크래시가 나며 강제로 종료됩니다.

인스턴스들이 계속해서 사용될 필요가 있을 때 메모리에서 해제되지 않도록 하기위해서,

ARC는 몇개의 properties, constants 그리고 variables에서 해당 인스턴스를 참조하고 있는지를 추적하여,

해당 인스턴스에 대한 하나 이상의 활성 참조가 존재한다면 deallocate하지 않습니다.

이를 위해 클래스 인스턴스를 properties, constants 그리고 variables에 할당할 때,

해당 인스턴스에 대한 강한 참조를 선언하면 됩니다.

인스턴스를 강하게 붙잡고 있다는 의미에서 강한 참조라고 표현하며,

강한 참조가 유지되고 있는 한 해당 인스턴스는 deallocate되지 않습니다.

## ARC in Action

ARC가 동작하는 것을 확인하기 위해서 아래 코드를 살펴보겠습니다.

메모리 alloc dealloc 과정을 표현하기 위해서 gif로 만들어보았어요.

![ARC%20733e9383f5ae4932970547df84695477/ezgif.com-gif-maker.gif](ARC%20733e9383f5ae4932970547df84695477/ezgif.com-gif-maker.gif)

person 인스턴스를 참조하는 변수가 더이상 없어지면서 dealloc되는 모습을 확인할 수 있습니다.

## Strong Reference Cycles Between Class Instance